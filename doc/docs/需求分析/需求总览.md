# 需求总览

## 1. 需求概述

LLMS（Land Lot Management System）的需求围绕**地块管理**和**任务追踪**两大核心展开，通过 GIS 地图可视化和移动端协同，实现从规划到执行的全流程管理。

### 1.1 需求来源

- **业务痛点**：地块边界复杂、数据分散、人工核对易错、现场协同低效
- **项目需求**：ND/2025/01 项目需要高效的地块管理工具
- **技术机遇**：CSDI 提供权威的官方地理数据和底图服务

### 1.2 需求优先级定义

| 优先级 | 定义 | 交付时间 |
|--------|------|----------|
| **P0（必须）** | 影响核心价值的功能，不交付则系统无法使用 | MVP（Week 1-7） |
| **P1（重要）** | 影响用户体验的功能，不交付会降低满意度 | MVP 或 Phase 2 |
| **P2（可选）** | 锦上添花的功能，可延后交付 | Phase 2+ |

## 2. 功能模块清单

### 2.1 Web Portal（管理端）

#### 2.1.1 地图与 GIS（P0）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| CSDI 底图集成 | P0 | 集成 Topographic Map API（HK80） | US-001 |
| 地名标注叠加 | P1 | 集成 Map Label API（HK80） | US-002 |
| 地图基础交互 | P0 | 缩放、平移、搜索定位 | US-003 |
| 底图切换 | P1 | 切换街道/地形/卫星底图 | US-004 |
| 图层管理 | P0 | 开关政府图层/自定义图层 | US-005 |
| 对比视图 | P1 | 同时显示多个图层进行对比 | US-006 |

#### 2.1.2 Land Lot 管理（P0）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| Land Lot 显示 | P0 | 在地图上显示 Land Lot 边界 | US-007 |
| Land Lot 绘制 | P0 | Site Admin 绘制 Land Lot 多边形 | US-008 |
| Land Lot 编辑 | P0 | Site Admin 编辑 Land Lot 形状 | US-009 |
| Land Lot 删除 | P0 | Site Admin 删除 Land Lot | US-010 |
| Land Lot 信息 | P0 | 填写和查看 Lot Number、状态等 | US-011 |

#### 2.1.3 Work Lot 管理（P0）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| Work Lot 显示 | P0 | 在地图上显示 Work Lot 边界 | US-012 |
| Work Lot 绘制 | P0 | Site Officer 绘制 Work Lot 多边形 | US-013 |
| Work Lot 编辑 | P0 | Site Officer 编辑 Work Lot 形状 | US-014 |
| Work Lot 删除 | P0 | Site Officer 删除 Work Lot | US-015 |
| Work Lot 信息 | P0 | 填写和查看 Operator、状态等 | US-016 |
| Snapping（吸附） | P1 | 绘制时自动吸附到 Land Lot 边界 | US-017 |
| 状态颜色 | P0 | 根据任务状态显示不同颜色 | US-018 |

#### 2.1.4 任务管理（P0）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| 任务创建 | P0 | 为 Work Lot 创建任务 | US-019 |
| 任务分配 | P0 | 指定负责人和截止时间 | US-020 |
| 任务列表 | P0 | 查看全部任务列表 | US-021 |
| 任务详情 | P0 | 查看任务详细信息 | US-022 |
| 任务状态更新 | P0 | 更新任务状态（进行中/完成） | US-023 |
| 任务删除 | P1 | 删除任务 | US-024 |
| 看板视图 | P1 | 日历或看板展示任务 | US-025 |
| 逾期预警 | P0 | 自动标记逾期任务为红色 | US-026 |

#### 2.1.5 报表与查询（P0）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| Work Lot 列表 | P0 | 查看全部 Work Lot 列表 | US-027 |
| Land Lot 列表 | P0 | 查看全部 Land Lot 列表 | US-028 |
| 点击查询 | P0 | 点击地块查看详情 | US-029 |
| 框选查询 | P1 | 绘制多边形查询范围内地块 | US-030 |
| 搜索定位 | P0 | 搜索关键词定位到地块 | US-031 |
| CSV 导出 | P1 | 导出 Work Lot 和 Land Lot 数据 | US-032 |

#### 2.1.6 用户与权限（P0）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| 角色切换 | P0 | 演示用角色切换功能 | US-033 |
| 权限控制 | P0 | 基于角色的功能和数据访问控制 | US-034 |
| 用户管理 | P2 | 添加/编辑/删除用户（概念展示） | US-035 |

### 2.2 Mobile App（现场端）

#### 2.2.1 地图与导航（P0）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| 底图显示 | P0 | 显示 CSDI 底图 | US-036 |
| 地图交互 | P0 | 缩放、平移、搜索 | US-037 |
| Work Lot 显示 | P0 | 显示 Work Lot 图层 | US-038 |

#### 2.2.2 任务管理（P0）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| 任务列表 | P0 | 查看分配给自己的任务 | US-039 |
| 任务详情 | P0 | 查看任务详细信息 | US-040 |
| 任务状态更新 | P0 | 更新任务状态和备注 | US-041 |

#### 2.2.3 GPS 核验（P0）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| GPS 定位 | P0 | 显示当前位置 | US-042 |
| 地理围栏 | P1 | 进入 Work Lot 范围时提示 | US-043 |
| Work Lot 信息 | P0 | 点击查看 Work Lot 详情 | US-044 |

#### 2.2.4 移动端特性（P1）

| 功能 | 优先级 | 描述 | 用户故事 |
|------|--------|------|----------|
| 离线模式 | P2 | 无网络时查看已下载数据 | - |
| 照片上传 | P2 | 上传现场照片作为证据 | - |
| 语音备注 | P2 | 录制语音备注 | - |

## 3. 非功能与约束（指引）

- 非功能指标、约束与依赖的统一口径请参考 [非功能与约束](./非功能与约束.md)。

## 4. 数据需求（摘要）

- 外部数据：CSDI 底图/标注、Soft Copy Plans、示例数据。  
- 内部数据：Land Lot / Work Lot / Task / User（前端本地持久化）。  
- 详细实体与字段请参考 [数据结构](../数据结构/Web端点数据结构.md)，领域关系与 GIS 策略请参考 [数据与GIS](../技术方案/数据与GIS.md)。

## 5. 集成需求（摘要）

- CSDI 底图/标注接入与坐标系口径详见 [数据与GIS](../技术方案/数据与GIS.md)。  
- 部署环境与访问方式详见 [非功能与约束](./非功能与约束.md)。

## 6. 约束与变更（指引）

- 约束、依赖与假设统一口径请参考 [非功能与约束](./非功能与约束.md)。
- 里程碑、风险与变更管理请参考 [目标与范围](../项目概览/目标与范围.md)。

## 7. 验收口径（指引）

- 功能验收请参考 [目标与范围](../项目概览/目标与范围.md) 与 [用户故事与验收](./用户故事与验收.md)。
- 非功能验收请参考 [非功能与约束](./非功能与约束.md)。

## 8. 需求追溯

所有需求都可以追溯到：
- **用户故事**：详见 [用户故事与验收](./用户故事与验收.md)
- **API 接口**：详见 [接口总览与规范](../接口文档/接口总览与规范.md)
- **技术方案**：详见 [总体架构](../技术方案/总体架构.md)

## 9. 参考文档

- [项目介绍](../项目概览/项目介绍.md)
- [目标与范围](../项目概览/目标与范围.md)
- [角色与权限](../项目概览/角色与权限.md)
- [用户故事与验收](./用户故事与验收.md)
- [非功能与约束](./非功能与约束.md)
- [术语表](../附录/术语表.md)
